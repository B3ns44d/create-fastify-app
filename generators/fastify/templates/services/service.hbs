'use strict'

const schema = require('./routes.schema')

module.exports = async function(fastify, opts) {

{{#each data}}
  {{#each this.path as |value key|}}
    {{#validMethod key}}
  fastify.{{key}}('{{../../endpointName}}', { schema: schema.{{camelCase (concat key ../../endpointName)}} }, async function (request, reply) {
    try {
    {{#checkSuccessResponses ../responses}}
      return reply
        .code({{code}})
        .send('{{data}}')
    {{/checkSuccessResponses}}
    } catch (e) {
    {{#checkErrorResponses ../responses}}
      return reply
        .code({{code}})
        .send('{{data}}')
    {{/checkErrorResponses}}
    }
  })

    {{/validMethod}}
  {{/each}}
{{/each}}
}

module.exports.autoPrefix = '{{basePath}}/{{prefix}}'
